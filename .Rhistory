rep(metadata$A1Dose1[drug], length(strsplit(metadata$A1PlateRange1[drug], ",")[[1]])),
rep(metadata$A1Dose2[drug], length(strsplit(metadata$A1PlateRange2[drug], ",")[[1]])),
rep(metadata$A1Dose3[drug], length(strsplit(metadata$A1PlateRange3[drug], ",")[[1]])),
rep(metadata$A2Dose0[drug], length(strsplit(metadata$A2PlateRange0[drug], ",")[[1]])),
rep(metadata$A2Dose1[drug], length(strsplit(metadata$A1PlateRange1[drug], ",")[[1]])),
rep(metadata$A2Dose2[drug], length(strsplit(metadata$A1PlateRange2[drug], ",")[[1]])),
rep(metadata$A2Dose3[drug], length(strsplit(metadata$A1PlateRange3[drug], ",")[[1]])))
anchors <- c(rep(metadata$Anchor1[drug], length(doses) / 2),
rep(metadata$Anchor2[drug], length(doses) / 2))
filenames <- rep(metadata$Filename[drug], length(doses))
lib_sheets <- rep(metadata$LibrarySheet[drug], length(doses))
samp_info <- rep(metadata$SampleInfo, length(doses))
temp <- data.frame(Filename = filenames,
SampleInfo = samp_info,
LibrarySheet = lib_sheets,
Anchor = anchors,
Dose = doses,
Plate = plates)
View(temp)
rm(temp)
# again, generalize this later
plates <- c(as.numeric(strsplit(metadata$A1PlateRange0[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A1PlateRange1[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A1PlateRange2[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A1PlateRange3[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A2PlateRange0[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A2PlateRange1[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A2PlateRange2[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A2PlateRange3[drug], ",")[[1]]))
doses <- c(rep(metadata$A1Dose0[drug], length(strsplit(metadata$A1PlateRange0[drug], ",")[[1]])),
rep(metadata$A1Dose1[drug], length(strsplit(metadata$A1PlateRange1[drug], ",")[[1]])),
rep(metadata$A1Dose2[drug], length(strsplit(metadata$A1PlateRange2[drug], ",")[[1]])),
rep(metadata$A1Dose3[drug], length(strsplit(metadata$A1PlateRange3[drug], ",")[[1]])),
rep(metadata$A2Dose0[drug], length(strsplit(metadata$A2PlateRange0[drug], ",")[[1]])),
rep(metadata$A2Dose1[drug], length(strsplit(metadata$A1PlateRange1[drug], ",")[[1]])),
rep(metadata$A2Dose2[drug], length(strsplit(metadata$A1PlateRange2[drug], ",")[[1]])),
rep(metadata$A2Dose3[drug], length(strsplit(metadata$A1PlateRange3[drug], ",")[[1]])))
anchors <- c(rep(metadata$Anchor1[drug], length(doses) / 2),
rep(metadata$Anchor2[drug], length(doses) / 2))
filenames <- rep(metadata$Filename[drug], length(doses))
lib_sheets <- rep(metadata$LibrarySheet[drug], length(doses))
samp_info <- rep(metadata$SampleInfo, length(doses))
temp <- data.frame(Filename = filenames,
SampleInfo = samp_info,
LibrarySheet = lib_sheets,
Anchor = anchors,
Dose = doses,
Plate = plates)
View(temp)
samp_info <- rep(metadata$SampleInfo[drug], length(doses))
temp <- data.frame(Filename = filenames,
SampleInfo = samp_info,
LibrarySheet = lib_sheets,
Anchor = anchors,
Dose = doses,
Plate = plates)
View(temp)
# finally, create a long version of the metadata dataframe
anchor_drugs <- c(unique(metadata$Anchor1), unique(metadata$Anchor2))
metadata_list <- list()
for (drug in seq(anchor_drugs)) {
# again, generalize this later
plates <- c(as.numeric(strsplit(metadata$A1PlateRange0[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A1PlateRange1[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A1PlateRange2[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A1PlateRange3[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A2PlateRange0[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A2PlateRange1[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A2PlateRange2[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A2PlateRange3[drug], ",")[[1]]))
doses <- c(rep(metadata$A1Dose0[drug], length(strsplit(metadata$A1PlateRange0[drug], ",")[[1]])),
rep(metadata$A1Dose1[drug], length(strsplit(metadata$A1PlateRange1[drug], ",")[[1]])),
rep(metadata$A1Dose2[drug], length(strsplit(metadata$A1PlateRange2[drug], ",")[[1]])),
rep(metadata$A1Dose3[drug], length(strsplit(metadata$A1PlateRange3[drug], ",")[[1]])),
rep(metadata$A2Dose0[drug], length(strsplit(metadata$A2PlateRange0[drug], ",")[[1]])),
rep(metadata$A2Dose1[drug], length(strsplit(metadata$A1PlateRange1[drug], ",")[[1]])),
rep(metadata$A2Dose2[drug], length(strsplit(metadata$A1PlateRange2[drug], ",")[[1]])),
rep(metadata$A2Dose3[drug], length(strsplit(metadata$A1PlateRange3[drug], ",")[[1]])))
anchors <- c(rep(metadata$Anchor1[drug], length(doses) / 2),
rep(metadata$Anchor2[drug], length(doses) / 2))
filenames <- rep(metadata$Filename[drug], length(doses))
lib_sheets <- rep(metadata$LibrarySheet[drug], length(doses))
samp_info <- rep(metadata$SampleInfo[drug], length(doses))
temp <- data.frame(Filename = filenames,
SampleInfo = samp_info,
LibrarySheet = lib_sheets,
Anchor = anchors,
Dose = doses,
Plate = plates)
metadata_list[[drug]] <- temp
}
drug=7
seq(anchor_drugs)
anchor_drugs[1]
# finally, create a long version of the metadata dataframe
anchor_drugs <- c(metadata$Anchor1, metadata$Anchor2)
seq(anchor_drugs)
metadata_list <- list()
for (drug in 1:18) {
# again, generalize this later
plates <- c(as.numeric(strsplit(metadata$A1PlateRange0[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A1PlateRange1[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A1PlateRange2[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A1PlateRange3[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A2PlateRange0[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A2PlateRange1[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A2PlateRange2[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A2PlateRange3[drug], ",")[[1]]))
doses <- c(rep(metadata$A1Dose0[drug], length(strsplit(metadata$A1PlateRange0[drug], ",")[[1]])),
rep(metadata$A1Dose1[drug], length(strsplit(metadata$A1PlateRange1[drug], ",")[[1]])),
rep(metadata$A1Dose2[drug], length(strsplit(metadata$A1PlateRange2[drug], ",")[[1]])),
rep(metadata$A1Dose3[drug], length(strsplit(metadata$A1PlateRange3[drug], ",")[[1]])),
rep(metadata$A2Dose0[drug], length(strsplit(metadata$A2PlateRange0[drug], ",")[[1]])),
rep(metadata$A2Dose1[drug], length(strsplit(metadata$A1PlateRange1[drug], ",")[[1]])),
rep(metadata$A2Dose2[drug], length(strsplit(metadata$A1PlateRange2[drug], ",")[[1]])),
rep(metadata$A2Dose3[drug], length(strsplit(metadata$A1PlateRange3[drug], ",")[[1]])))
anchors <- c(rep(metadata$Anchor1[drug], length(doses) / 2),
rep(metadata$Anchor2[drug], length(doses) / 2))
filenames <- rep(metadata$Filename[drug], length(doses))
lib_sheets <- rep(metadata$LibrarySheet[drug], length(doses))
samp_info <- rep(metadata$SampleInfo[drug], length(doses))
temp <- data.frame(Filename = filenames,
SampleInfo = samp_info,
LibrarySheet = lib_sheets,
Anchor = anchors,
Dose = doses,
Plate = plates)
metadata_list[[drug]] <- temp
}
metadata_list <- list()
for (drug in 1:18) {
# again, generalize this later
plates <- c(as.numeric(strsplit(metadata$A1PlateRange0[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A1PlateRange1[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A1PlateRange2[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A1PlateRange3[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A2PlateRange0[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A2PlateRange1[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A2PlateRange2[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A2PlateRange3[drug], ",")[[1]]))
# doses <- c(rep(metadata$A1Dose0[drug], length(strsplit(metadata$A1PlateRange0[drug], ",")[[1]])),
#            rep(metadata$A1Dose1[drug], length(strsplit(metadata$A1PlateRange1[drug], ",")[[1]])),
#            rep(metadata$A1Dose2[drug], length(strsplit(metadata$A1PlateRange2[drug], ",")[[1]])),
#            rep(metadata$A1Dose3[drug], length(strsplit(metadata$A1PlateRange3[drug], ",")[[1]])),
#            rep(metadata$A2Dose0[drug], length(strsplit(metadata$A2PlateRange0[drug], ",")[[1]])),
#            rep(metadata$A2Dose1[drug], length(strsplit(metadata$A1PlateRange1[drug], ",")[[1]])),
#            rep(metadata$A2Dose2[drug], length(strsplit(metadata$A1PlateRange2[drug], ",")[[1]])),
#            rep(metadata$A2Dose3[drug], length(strsplit(metadata$A1PlateRange3[drug], ",")[[1]])))
# anchors <- c(rep(metadata$Anchor1[drug], length(doses) / 2),
#              rep(metadata$Anchor2[drug], length(doses) / 2))
# filenames <- rep(metadata$Filename[drug], length(doses))
# lib_sheets <- rep(metadata$LibrarySheet[drug], length(doses))
# samp_info <- rep(metadata$SampleInfo[drug], length(doses))
# temp <- data.frame(Filename = filenames,
#                    SampleInfo = samp_info,
#                    LibrarySheet = lib_sheets,
#                    Anchor = anchors,
#                    Dose = doses,
#                    Plate = plates)
metadata_list[[drug]] <- plates
}
View(metadata_list)
for (drug in 1:18) {
# again, generalize this later
plates <- c(as.numeric(strsplit(metadata$A1PlateRange0[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A1PlateRange1[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A1PlateRange2[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A1PlateRange3[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A2PlateRange0[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A2PlateRange1[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A2PlateRange2[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A2PlateRange3[drug], ",")[[1]]))
doses <- c(rep(metadata$A1Dose0[drug], length(strsplit(metadata$A1PlateRange0[drug], ",")[[1]])),
rep(metadata$A1Dose1[drug], length(strsplit(metadata$A1PlateRange1[drug], ",")[[1]])),
rep(metadata$A1Dose2[drug], length(strsplit(metadata$A1PlateRange2[drug], ",")[[1]])),
rep(metadata$A1Dose3[drug], length(strsplit(metadata$A1PlateRange3[drug], ",")[[1]])),
rep(metadata$A2Dose0[drug], length(strsplit(metadata$A2PlateRange0[drug], ",")[[1]])),
rep(metadata$A2Dose1[drug], length(strsplit(metadata$A1PlateRange1[drug], ",")[[1]])),
rep(metadata$A2Dose2[drug], length(strsplit(metadata$A1PlateRange2[drug], ",")[[1]])),
rep(metadata$A2Dose3[drug], length(strsplit(metadata$A1PlateRange3[drug], ",")[[1]])))
# anchors <- c(rep(metadata$Anchor1[drug], length(doses) / 2),
#              rep(metadata$Anchor2[drug], length(doses) / 2))
# filenames <- rep(metadata$Filename[drug], length(doses))
# lib_sheets <- rep(metadata$LibrarySheet[drug], length(doses))
# samp_info <- rep(metadata$SampleInfo[drug], length(doses))
temp <- data.frame(#Filename = filenames,
#SampleInfo = samp_info,
#LibrarySheet = lib_sheets,
#Anchor = anchors,
Dose = doses,
Plate = plates)
metadata_list[[drug]] <- plates
}
metadata_list <- list()
for (drug in 1:18) {
# again, generalize this later
plates <- c(as.numeric(strsplit(metadata$A1PlateRange0[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A1PlateRange1[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A1PlateRange2[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A1PlateRange3[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A2PlateRange0[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A2PlateRange1[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A2PlateRange2[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A2PlateRange3[drug], ",")[[1]]))
doses <- c(rep(metadata$A1Dose0[drug], length(strsplit(metadata$A1PlateRange0[drug], ",")[[1]])),
rep(metadata$A1Dose1[drug], length(strsplit(metadata$A1PlateRange1[drug], ",")[[1]])),
rep(metadata$A1Dose2[drug], length(strsplit(metadata$A1PlateRange2[drug], ",")[[1]])),
rep(metadata$A1Dose3[drug], length(strsplit(metadata$A1PlateRange3[drug], ",")[[1]])),
rep(metadata$A2Dose0[drug], length(strsplit(metadata$A2PlateRange0[drug], ",")[[1]])),
rep(metadata$A2Dose1[drug], length(strsplit(metadata$A2PlateRange1[drug], ",")[[1]])),
rep(metadata$A2Dose2[drug], length(strsplit(metadata$A2PlateRange2[drug], ",")[[1]])),
rep(metadata$A2Dose3[drug], length(strsplit(metadata$A2PlateRange3[drug], ",")[[1]])))
anchors <- c(rep(metadata$Anchor1[drug], length(doses) / 2),
rep(metadata$Anchor2[drug], length(doses) / 2))
filenames <- rep(metadata$Filename[drug], length(doses))
lib_sheets <- rep(metadata$LibrarySheet[drug], length(doses))
samp_info <- rep(metadata$SampleInfo[drug], length(doses))
temp <- data.frame(Filename = filenames,
SampleInfo = samp_info,
LibrarySheet = lib_sheets,
Anchor = anchors,
Dose = doses,
Plate = plates)
metadata_list[[drug]] <- temp
}
View(metadata_list)
# reformat library datasets
library_drugs <- unique(library_key$Compound)
# create librarykey dataframe w/ compound, plate, row/col, & dose
compound_list <- list()
for (drug in seq(library_drugs)) {
# make the generalizable later
plates <- c(as.numeric(strsplit(library_key[drug, ]$Plate1, ",")[[1]]),
as.numeric(strsplit(library_key[drug, ]$Plate2, ",")[[1]]),
as.numeric(strsplit(library_key[drug, ]$Plate3, ",")[[1]]),
as.numeric(strsplit(library_key[drug, ]$Plate4, ",")[[1]]),
as.numeric(strsplit(library_key[drug, ]$Plate5, ",")[[1]]),
as.numeric(strsplit(library_key[drug, ]$Plate6, ",")[[1]]))
doses <- c(rep(library_key$`Dose1.(10uM)`[drug], length(strsplit(library_key$Plate1[1], ",")[[1]])),
rep(library_key$`Dose2.(3uM)`[drug], length(strsplit(library_key$Plate1[2], ",")[[1]])),
rep(library_key$`Dose3(1uM)`[drug], length(strsplit(library_key$Plate1[3], ",")[[1]])),
rep(library_key$`Dose4.(300.nM)`[drug], length(strsplit(library_key$Plate1[4], ",")[[1]])),
rep(library_key$`Dose5(100nM)`[drug], length(strsplit(library_key$Plate1[5], ",")[[1]])),
rep(library_key$`Dose6(10nM)`[drug], length(strsplit(library_key$Plate1[6], ",")[[1]])))
rows <- rep(library_key$Row[drug], length(doses))
columns <- c(rep(library_key$Column1[drug], length(strsplit(library_key$Plate1[1], ",")[[1]])),
rep(library_key$Column2[drug], length(strsplit(library_key$Plate1[2], ",")[[1]])),
rep(library_key$Column3[drug], length(strsplit(library_key$Plate1[3], ",")[[1]])),
rep(library_key$Column4[drug], length(strsplit(library_key$Plate1[4], ",")[[1]])),
rep(library_key$Column5[drug], length(strsplit(library_key$Plate1[5], ",")[[1]])),
rep(library_key$Column6[drug], length(strsplit(library_key$Plate1[6], ",")[[1]])))
compound <- rep(library_key$Compound[drug], length(doses))
temp <- data.frame(Compound = compound,
Plate = plates,
Does = doses,
Row = rows,
Column = columns,
stringsAsFactors = FALSE)
compound_list[[drug]] <- temp
}
# now coerce to a dataframe
compound_df_librarykey <- rbindlist(compound_list)
# repeat the previous operation for librarykey2016
library_drugs <- unique(library_key_2016$Compound)
compound_list <- list()
for (drug in seq(library_drugs)) {
# make this generalizable later
plates <- c(as.numeric(strsplit(library_key_2016[drug, ]$Plate1, ",")[[1]]),
as.numeric(strsplit(library_key_2016[drug, ]$Plate2, ",")[[1]]),
as.numeric(strsplit(library_key_2016[drug, ]$Plate3, ",")[[1]]),
as.numeric(strsplit(library_key_2016[drug, ]$Plate4, ",")[[1]]),
as.numeric(strsplit(library_key_2016[drug, ]$Plate5, ",")[[1]]),
as.numeric(strsplit(library_key_2016[drug, ]$Plate6, ",")[[1]]))
doses <- c(rep(library_key_2016$Dose1[drug], length(strsplit(library_key_2016$Plate1[1], ",")[[1]])),
rep(library_key_2016$Dose2[drug], length(strsplit(library_key_2016$Plate1[2], ",")[[1]])),
rep(library_key_2016$Dose3[drug], length(strsplit(library_key_2016$Plate1[3], ",")[[1]])),
rep(library_key_2016$Dose4[drug], length(strsplit(library_key_2016$Plate1[4], ",")[[1]])),
rep(library_key_2016$Dose5[drug], length(strsplit(library_key_2016$Plate1[5], ",")[[1]])),
rep(library_key_2016$Dose6[drug], length(strsplit(library_key_2016$Plate1[6], ",")[[1]])))
columns <- c(rep(library_key_2016$Column1[drug], length(strsplit(library_key_2016$Plate1[1], ",")[[1]])),
rep(library_key_2016$Column2[drug], length(strsplit(library_key_2016$Plate1[2], ",")[[1]])),
rep(library_key_2016$Column3[drug], length(strsplit(library_key_2016$Plate1[3], ",")[[1]])),
rep(library_key_2016$Column4[drug], length(strsplit(library_key_2016$Plate1[4], ",")[[1]])),
rep(library_key_2016$Column5[drug], length(strsplit(library_key_2016$Plate1[5], ",")[[1]])),
rep(library_key_2016$Column6[drug], length(strsplit(library_key_2016$Plate1[6], ",")[[1]])))
compound <- rep(library_key_2016$Compound[drug], length(doses))
rows <- rep(library_key$Row[drug], length(doses))
temp <- data.frame(Compound = compound,
Plate = plates,
Does = doses,
Row = rows,
Column = columns,
stringsAsFactors = FALSE)
compound_list[[drug]] <- temp
}
# again coerce to dataframe
compound_df_librarykey2016 <- rbindlist(compound_list)
# finally, create a long version of the metadata dataframe
metadata_list <- list()
for (drug in seq(nrow(metadata))) {
# again, generalize this later
plates <- c(as.numeric(strsplit(metadata$A1PlateRange0[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A1PlateRange1[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A1PlateRange2[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A1PlateRange3[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A2PlateRange0[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A2PlateRange1[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A2PlateRange2[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A2PlateRange3[drug], ",")[[1]]))
doses <- c(rep(metadata$A1Dose0[drug], length(strsplit(metadata$A1PlateRange0[drug], ",")[[1]])),
rep(metadata$A1Dose1[drug], length(strsplit(metadata$A1PlateRange1[drug], ",")[[1]])),
rep(metadata$A1Dose2[drug], length(strsplit(metadata$A1PlateRange2[drug], ",")[[1]])),
rep(metadata$A1Dose3[drug], length(strsplit(metadata$A1PlateRange3[drug], ",")[[1]])),
rep(metadata$A2Dose0[drug], length(strsplit(metadata$A2PlateRange0[drug], ",")[[1]])),
rep(metadata$A2Dose1[drug], length(strsplit(metadata$A2PlateRange1[drug], ",")[[1]])),
rep(metadata$A2Dose2[drug], length(strsplit(metadata$A2PlateRange2[drug], ",")[[1]])),
rep(metadata$A2Dose3[drug], length(strsplit(metadata$A2PlateRange3[drug], ",")[[1]])))
anchors <- c(rep(metadata$Anchor1[drug], length(doses) / 2),
rep(metadata$Anchor2[drug], length(doses) / 2))
filenames <- rep(metadata$Filename[drug], length(doses))
lib_sheets <- rep(metadata$LibrarySheet[drug], length(doses))
samp_info <- rep(metadata$SampleInfo[drug], length(doses))
temp <- data.frame(Filename = filenames,
SampleInfo = samp_info,
LibrarySheet = lib_sheets,
Anchor = anchors,
Dose = doses,
Plate = plates,
stringsAsFactors = FALSE)
metadata_list[[drug]] <- temp
}
# coerce to dataframe
metadata_df <- rbindlist(metadata_list)
View(metadata_df)
410/18
dim(metadata_list[[1]])
410/6
devtools::document()
library(YehLabHTS)
set.seed(629)  # not explicitly needed, but just in case
# load metadata
metadata <- readData(parent.dir = "./data/",
file.name = "v3_YehLab_compound_library_synergy_screen_metadata",
col.names = TRUE)
View(metadata)
# remove unecessary metadata
metadata <- metadata[-c(3, 4), ]
# load library sheets
library_key <- readData(parent.dir = "./data/",
file.name = "v3_YehLab_compound_library_synergy_screen_metadata",
sheet.name = "LibraryKey",
col.names = TRUE)
library_key_2016 <- readData(parent.dir = "./data/",
file.name = "v3_YehLab_compound_library_synergy_screen_metadata",
sheet.name = "LibraryKey2016",
col.names = TRUE)
# reformat library datasets
library_drugs <- unique(library_key$Compound)
# create librarykey dataframe w/ compound, plate, row/col, & dose
compound_list <- list()
for (drug in seq(library_drugs)) {
# make the generalizable later
plates <- c(as.numeric(strsplit(library_key[drug, ]$Plate1, ",")[[1]]),
as.numeric(strsplit(library_key[drug, ]$Plate2, ",")[[1]]),
as.numeric(strsplit(library_key[drug, ]$Plate3, ",")[[1]]),
as.numeric(strsplit(library_key[drug, ]$Plate4, ",")[[1]]),
as.numeric(strsplit(library_key[drug, ]$Plate5, ",")[[1]]),
as.numeric(strsplit(library_key[drug, ]$Plate6, ",")[[1]]))
doses <- c(rep(library_key$`Dose1.(10uM)`[drug], length(strsplit(library_key$Plate1[1], ",")[[1]])),
rep(library_key$`Dose2.(3uM)`[drug], length(strsplit(library_key$Plate1[2], ",")[[1]])),
rep(library_key$`Dose3(1uM)`[drug], length(strsplit(library_key$Plate1[3], ",")[[1]])),
rep(library_key$`Dose4.(300.nM)`[drug], length(strsplit(library_key$Plate1[4], ",")[[1]])),
rep(library_key$`Dose5(100nM)`[drug], length(strsplit(library_key$Plate1[5], ",")[[1]])),
rep(library_key$`Dose6(10nM)`[drug], length(strsplit(library_key$Plate1[6], ",")[[1]])))
rows <- rep(library_key$Row[drug], length(doses))
columns <- c(rep(library_key$Column1[drug], length(strsplit(library_key$Plate1[1], ",")[[1]])),
rep(library_key$Column2[drug], length(strsplit(library_key$Plate1[2], ",")[[1]])),
rep(library_key$Column3[drug], length(strsplit(library_key$Plate1[3], ",")[[1]])),
rep(library_key$Column4[drug], length(strsplit(library_key$Plate1[4], ",")[[1]])),
rep(library_key$Column5[drug], length(strsplit(library_key$Plate1[5], ",")[[1]])),
rep(library_key$Column6[drug], length(strsplit(library_key$Plate1[6], ",")[[1]])))
compound <- rep(library_key$Compound[drug], length(doses))
temp <- data.frame(Compound = compound,
Plate = plates,
Does = doses,
Row = rows,
Column = columns,
stringsAsFactors = FALSE)
compound_list[[drug]] <- temp
}
# now coerce to a dataframe
compound_df_librarykey <- rbindlist(compound_list)
# repeat the previous operation for librarykey2016
library_drugs <- unique(library_key_2016$Compound)
compound_list <- list()
for (drug in seq(library_drugs)) {
# make this generalizable later
plates <- c(as.numeric(strsplit(library_key_2016[drug, ]$Plate1, ",")[[1]]),
as.numeric(strsplit(library_key_2016[drug, ]$Plate2, ",")[[1]]),
as.numeric(strsplit(library_key_2016[drug, ]$Plate3, ",")[[1]]),
as.numeric(strsplit(library_key_2016[drug, ]$Plate4, ",")[[1]]),
as.numeric(strsplit(library_key_2016[drug, ]$Plate5, ",")[[1]]),
as.numeric(strsplit(library_key_2016[drug, ]$Plate6, ",")[[1]]))
doses <- c(rep(library_key_2016$Dose1[drug], length(strsplit(library_key_2016$Plate1[1], ",")[[1]])),
rep(library_key_2016$Dose2[drug], length(strsplit(library_key_2016$Plate1[2], ",")[[1]])),
rep(library_key_2016$Dose3[drug], length(strsplit(library_key_2016$Plate1[3], ",")[[1]])),
rep(library_key_2016$Dose4[drug], length(strsplit(library_key_2016$Plate1[4], ",")[[1]])),
rep(library_key_2016$Dose5[drug], length(strsplit(library_key_2016$Plate1[5], ",")[[1]])),
rep(library_key_2016$Dose6[drug], length(strsplit(library_key_2016$Plate1[6], ",")[[1]])))
columns <- c(rep(library_key_2016$Column1[drug], length(strsplit(library_key_2016$Plate1[1], ",")[[1]])),
rep(library_key_2016$Column2[drug], length(strsplit(library_key_2016$Plate1[2], ",")[[1]])),
rep(library_key_2016$Column3[drug], length(strsplit(library_key_2016$Plate1[3], ",")[[1]])),
rep(library_key_2016$Column4[drug], length(strsplit(library_key_2016$Plate1[4], ",")[[1]])),
rep(library_key_2016$Column5[drug], length(strsplit(library_key_2016$Plate1[5], ",")[[1]])),
rep(library_key_2016$Column6[drug], length(strsplit(library_key_2016$Plate1[6], ",")[[1]])))
compound <- rep(library_key_2016$Compound[drug], length(doses))
rows <- rep(library_key$Row[drug], length(doses))
temp <- data.frame(Compound = compound,
Plate = plates,
Dose = doses,
Row = rows,
Column = columns,
stringsAsFactors = FALSE)
compound_list[[drug]] <- temp
}
# coerce to dataframe
compound_df_librarykey2016 <- rbindlist(compound_list)
# finally, create a long version of the metadata dataframe
metadata_list <- list()
for (drug in seq(nrow(metadata))) {
# again, generalize this later
plates <- c(as.numeric(strsplit(metadata$A1PlateRange0[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A1PlateRange1[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A1PlateRange2[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A1PlateRange3[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A2PlateRange0[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A2PlateRange1[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A2PlateRange2[drug], ",")[[1]]),
as.numeric(strsplit(metadata$A2PlateRange3[drug], ",")[[1]]))
doses <- c(rep(metadata$A1Dose0[drug], length(strsplit(metadata$A1PlateRange0[drug], ",")[[1]])),
rep(metadata$A1Dose1[drug], length(strsplit(metadata$A1PlateRange1[drug], ",")[[1]])),
rep(metadata$A1Dose2[drug], length(strsplit(metadata$A1PlateRange2[drug], ",")[[1]])),
rep(metadata$A1Dose3[drug], length(strsplit(metadata$A1PlateRange3[drug], ",")[[1]])),
rep(metadata$A2Dose0[drug], length(strsplit(metadata$A2PlateRange0[drug], ",")[[1]])),
rep(metadata$A2Dose1[drug], length(strsplit(metadata$A2PlateRange1[drug], ",")[[1]])),
rep(metadata$A2Dose2[drug], length(strsplit(metadata$A2PlateRange2[drug], ",")[[1]])),
rep(metadata$A2Dose3[drug], length(strsplit(metadata$A2PlateRange3[drug], ",")[[1]])))
anchors <- c(rep(metadata$Anchor1[drug], length(doses) / 2),
rep(metadata$Anchor2[drug], length(doses) / 2))
filenames <- rep(metadata$Filename[drug], length(doses))
lib_sheets <- rep(metadata$LibrarySheet[drug], length(doses))
samp_info <- rep(metadata$SampleInfo[drug], length(doses))
temp <- data.frame(Filename = filenames,
SampleInfo = samp_info,
LibrarySheet = lib_sheets,
Anchor = anchors,
Dose = doses,
Plate = plates,
stringsAsFactors = FALSE)
metadata_list[[drug]] <- temp
}
# coerce to dataframe
metadata_df <- rbindlist(metadata_list)
21*24
View(compound_df_librarykey)
7392/176
7392/21
7392/24
7392*2
7392*2/336
21*16
file=metadata_df$Filename[1]
metadata_df$LibrarySheet[file] == "ibraryey"
metadata_df$LibrarySheet[file] == "LibraryKey"
metadata_df$LibrarySheet[file][1] == "LibraryKey"
metadata_df$LibrarySheet[1] == "LibraryKey"
?Seurat::SCTransform
View(library_key)
View(metadata)
View(metadata_df)
336*21*20
load("~/Desktop/Bioinformatics/HTS Screening/2D_screen_pilot_compiledV3.Rdata")
View(final)
t=as.data.frame(final[[1]])
View(t)
16*336*24
16*336*21
4229*8*34
21*18*22
source('~/Desktop/YehLabHTS/R/reformatetadata.R')
View(t)
4229/22
4229/21
4229/24
4229/23
336*24
336*24/2
load("~/Desktop/Bioinformatics/HTS Screening/2D_screen_pilot_compiledV3.Rdata")
load("~/Desktop/Bioinformatics/HTS Screening/2D_screen_pilot_processedV3.Rdata")
View(ff)
t=ff[[1]]
t=as.data.frame(ff[[1]])
View(t)
View(ff)
tail(ff)
ff=data.frame(ff)
View(ff)
devtools::document()
rm(list = c("reformatMetadata"))
devtools::document()
devtools::document()
library(YehLabHTS)
