ylim(0, 500)+
xlim(-2, 2)
ggqqplot(exSub$PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131)+
#ylim(0, 500)+
xlim(-2, 2)
ggqqplot(exSub$PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131)+
#ylim(0, 500)+
#xlim(-2, 2)
#scatterplot with regression
ggplot(exSub, aes(x = log2(PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131),
y = log2(PDXcells_P180129T1LVp1m2826_DMEMF12_S4_eaton131)))+ #, colour= log(PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131)))+
geom_point()+
stat_cor(method = "pearson")
ggqqplot(exSub$PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131)
CorrT
ggplot(exSub, aes(x = log2(PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131),
y = log2(PDXcells_P180129T1LVp1m2826_DMEMF12_S4_eaton131)))+ #, colour= log(PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131)))+
geom_point()+
stat_cor(method = "pearson")
#scatterplot with regression
ggplot(exSub, aes(x = log2(PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131),
y = log2(PDXcells_P180129T1LVp1m2826_DMEMF12_S4_eaton131)))+ #, colour= log(PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131)))+
geom_point()+
geom_smooth(method=lm)+
stat_cor(method = "pearson")
class(Yeh_Salmon
)
allPDXclassical <- list("P130411T1", "P100422T1","P190117T2OM", "P110616T1", "P180129T1LV")
type <- c("PDXcells")
drugTx <- c("untreated", "")
treatment1 <- c("untreated", "")
lastFilename <- c()
lastFilename2 <- c()
for (i in 1:length(allPDXclassical)){
#all seq runs for a given cell line in the candidate pdx lines
allRuns <- subset(Yeh_Salmon[["sampInfo"]], line ==  allPDXclassical[[i]])
allRuns <- filter(allRuns, DrugTx %in% drugTx, Treatment1 %in% treatment1, Type %in% type)
#most recent file (last file in allRuns)
filename <- tail(as.character(allRuns$filename), n = 10)
#list of the last file names for each candidate line
lastFilename <- c(lastFilename, filename)
exSub <- subset(Yeh_Salmon[["ex"]], select = c(lastFilename))
# allRuns2 <- subset(Yeh_Salmon[["sampInfo"]], line ==  allPDXclassical[[5]])
# allRuns2 <- filter(allRuns2, Type %in% type, DrugTx %in% drugTx, Treatment1 %in% treatment1)
# #allRuns <- rbind(allRuns, allRuns2)
# filename2 <- tail(as.character(allRuns2$filename), n = 10)
# lastFilename2 <- c(lastFilename2, filename2)
# exSub <- subset(Yeh_Salmon[["ex"]], select = c(lastFilename2))
}
View(exSub)
View(allRuns)
type <- c("PDXcells")
drugTx <- c("untreated", "")
treatment1 <- c("untreated", "")
lastFilename <- c()
lastFilename2 <- c()
for (i in 1:length(allPDXclassical)){
#all seq runs for a given cell line in the candidate pdx lines
allRuns <- subset(Yeh_Salmon[["sampInfo"]], line ==  allPDXclassical[[i]])
allRuns <- filter(allRuns, DrugTx %in% drugTx, Treatment1 %in% treatment1, Type %in% type)
#most recent file (last file in allRuns)
filename <- tail(as.character(allRuns$filename), n = 10)
#list of the last file names for each candidate line
lastFilename <- c(lastFilename, filename)
exSub <- subset(Yeh_Salmon[["ex"]], select = c(lastFilename))
# allRuns2 <- subset(Yeh_Salmon[["sampInfo"]], line ==  allPDXclassical[[5]])
# allRuns2 <- filter(allRuns2, Type %in% type, DrugTx %in% drugTx, Treatment1 %in% treatment1)
# #allRuns <- rbind(allRuns, allRuns2)
# filename2 <- tail(as.character(allRuns2$filename), n = 10)
# lastFilename2 <- c(lastFilename2, filename2)
# exSub <- subset(Yeh_Salmon[["ex"]], select = c(lastFilename2))
}
exSub[] <- sapply(round(exSub[]), as.integer)
#colnames(exSub) <-c(rep(allPDXclassical[[1]], 3),
#                    rep(allPDXclassical[[2]], 3),
#                    rep(allPDXclassical[[3]], 3),
#                    rep(allPDXclassical[[4]], 3),
#                    rep(allPDXclassical[[5]], 2))
#create the metadata dataframe = coldata
coldata <- data.frame(
Line = factor(c(rep(allPDXclassical[[1]], 3),
rep(allPDXclassical[[2]], 3),
rep(allPDXclassical[[3]], 3),
rep(allPDXclassical[[4]], 1),
rep(allPDXclassical[[5]], 1))),
Class = factor(c(rep("control", 3),
rep("candidate", 3),
rep("candidate", 3),
rep("control", 1),
rep("candidate", 1)))
#Repeats = factor(rep(1:3, len =14))
)
coldata <- cbind(colnames(exSub), coldata)
names(coldata)[1] <- "filename"
coldata$Line <- factor(coldata$Line, levels = c(allPDXclassical))
coldata$filename <- factor(coldata$filename, levels = c(lastFilename))
coldata$Class <- factor(coldata$Class, levels = c("control","candidate"))
coldata$Class <- relevel(coldata$Class, "control" )
ddsFullCountTable <- DESeqDataSetFromMatrix(
countData = exSub,
colData = coldata,
design = ~ 1 )
dds <- ddsFullCountTable
#run the DESeq pipeline
dds <- DESeq(dds)
count <- counts(dds, normalized = T)
View(count)
#results table
res <- results(dds)
vsd <- vst(dds)
plotPCA(vsd, intgroup = c("P180129T1LV", "P110616T1"))
col(colData(dds))
View(coldata)
#plotPCA(rld, intgroup = c("Line"))
res <- results(dds, contrast = c("Line", "P180129T1LV", "P110616T1") )
plotPCA(vsd, intgroup = c("PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131", "PDXcells_P180129T1LVp1m2826_DMEMF12_S4_eaton131"))
#rld <- rlog(dds, blind=TRUE)
plotPCA(vsd, intgroup = c("Line"))
ggplot(Sub, aes(x = count$PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131,
y = count$PDXcells_P180129T1LVp1m2826_DMEMF12_S4_eaton131))+ #, colour= log(PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131)))+
geom_point()+
geom_smooth(method=lm)+
stat_cor(method = "pearson")
ggplot(exSub, aes(x = count$PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131,
y = count$PDXcells_P180129T1LVp1m2826_DMEMF12_S4_eaton131))+ #, colour= log(PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131)))+
geom_point()+
geom_smooth(method=lm)+
stat_cor(method = "pearson")
ggplot(count, aes(x = PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131,
y = PDXcells_P180129T1LVp1m2826_DMEMF12_S4_eaton131))+ #, colour= log(PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131)))+
geom_point()+
geom_smooth(method=lm)+
stat_cor(method = "pearson")
class(count)
count <- as.data.frame(counts(dds, normalized = T))
ggplot(count, aes(x = PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131,
y = PDXcells_P180129T1LVp1m2826_DMEMF12_S4_eaton131))+ #, colour= log(PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131)))+
geom_point()+
geom_smooth(method=lm)+
stat_cor(method = "pearson")
ggplot(count, aes(x = PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131,
y = PDXcells_P180129T1LVp1m2826_DMEMF12_S4_eaton131, ymax = 5e4))+
geom_point()+
geom_smooth(method=lm)+
stat_cor(method = "pearson")
#scatterplot with regression
ggplot(count, aes(x = PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131,
y = PDXcells_P180129T1LVp1m2826_DMEMF12_S4_eaton131))+
ylim(0, 5e4)+
geom_point()+
geom_smooth(method=lm)+
stat_cor(method = "pearson")
#scatterplot with regression
ggplot(count, aes(x = PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131,
y = PDXcells_P180129T1LVp1m2826_DMEMF12_S4_eaton131))+
ylim(0, 1e4)+
geom_point()+
geom_smooth(method=lm)+
stat_cor(method = "pearson")
ggplot(count, aes(x = PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131,
y = 	P130411_Cells_S1_eaton02))+
ylim(0, 1e4)+
geom_point()+
geom_smooth(method=lm)+
stat_cor(method = "pearson")
#scatterplot 	P130411_Cells_S1_eaton02 vs 110616 for comparison
ggplot(count, aes(x = PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131,
y = 	P130411_Cells_S1_eaton02))+
#ylim(0, 1e4)+
geom_point()+
geom_smooth(method=lm)+
stat_cor(method = "pearson")
ggplot(count, aes(x = PDXcells_P180129T1LVp1m2826_DMEMF12_S4_eaton131,
y = 	P130411_Cells_S1_eaton02))+
#ylim(0, 1e4)+
geom_point()+
geom_smooth(method=lm)+
stat_cor(method = "pearson")
ggplot(count, aes(x = PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131,
y = PDXcells_P180129T1LVp1m2826_DMEMF12_S4_eaton131))+
ylim(0, 1e4)+
geom_point()+
geom_smooth(method=lm)+
stat_cor(method = "pearson")
#scatterplot P180129T1LV vs P110616T1
ggplot(count, aes(x = PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131,
y = PDXcells_P180129T1LVp1m2826_DMEMF12_S4_eaton131))+
#ylim(0, 1e4)+
geom_point()+
geom_smooth(method=lm)+
stat_cor(method = "pearson")
ggplot(count, aes(x = P100422_Cells_S3_eaton02,
y = 	P130411_Cells_S1_eaton02))+
#ylim(0, 1e4)+
geom_point()+
geom_smooth(method=lm)+
stat_cor(method = "pearson")
View(vsd)
ddsFullCountTable <- DESeqDataSetFromMatrix(
countData = exSub,
colData = coldata,
design = ~ 1 )
dds <- ddsFullCountTable
#run the DESeq pipeline
dds <- DESeq(dds)
count <- as.data.frame(counts(dds, normalized = T))
y = PDXcells_P180129T1LVp1m2826_DMEMF12_S4_eaton131))+
#ylim(0, 1e4)+
geom_point()+
geom_smooth(method=lm)+
stat_cor(method = "pearson")
ggplot(count, aes(x = PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131,
y = PDXcells_P180129T1LVp1m2826_DMEMF12_S4_eaton131))+
#ylim(0, 1e4)+
geom_point()+
geom_smooth(method=lm)+
stat_cor(method = "pearson")
ddsFullCountTable <- DESeqDataSetFromMatrix(
countData = exSub,
colData = coldata,
design = ~ Line )
dds <- ddsFullCountTable
#run the DESeq pipeline
dds <- DESeq(dds)
count <- as.data.frame(counts(dds, normalized = T))
ggplot(count, aes(x = PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131,
y = PDXcells_P180129T1LVp1m2826_DMEMF12_S4_eaton131))+
#ylim(0, 1e4)+
geom_point()+
geom_smooth(method=lm)+
stat_cor(method = "pearson")
ggplot(count, aes(x = PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131,
y = 	P130411_Cells_S1_eaton02))+
#ylim(0, 1e4)+
geom_point()+
geom_smooth(method=lm)+
stat_cor(method = "pearson")
ggplot(count, aes(x = PDXcells_P180129T1LVp1m2826_DMEMF12_S4_eaton131,
y = 	P130411_Cells_S1_eaton02))+
#ylim(0, 1e4)+
geom_point()+
geom_smooth(method=lm)+
stat_cor(method = "pearson")
ggplot(count, aes(x = P100422_Cells_S3_eaton02,
y = 	P130411_Cells_S1_eaton02))+
#ylim(0, 1e4)+
geom_point()+
geom_smooth(method=lm)+
stat_cor(method = "pearson")
similarLines <- list("P110616T1", "P180129T1LV")
type <- c("PDXcells")
drugTx <- c("untreated", "")
treatment1 <- c("untreated", "")
lastFilename <- c()
lastFilename2 <- c()
for (i in 1:length(similarLines)){
#all seq runs for a given cell line in the candidate pdx lines
allRuns <- subset(Yeh_Salmon[["sampInfo"]], line ==  similarLines[[i]])
allRuns <- filter(allRuns, DrugTx %in% drugTx, Treatment1 %in% treatment1, Type %in% type)
#most recent file (last file in allRuns)
filename <- tail(as.character(allRuns$filename), n = 10)
#list of the last file names for each candidate line
lastFilename <- c(lastFilename, filename)
Sub <- subset(Yeh_Salmon[["ex"]], select = c(lastFilename))
}
Sub[] <- sapply(round(exSub[]), as.integer)
View(Sub)
coldata2 <- data.frame(
Line = factor(similarLines[[1]], similarLines[[1]])
)
coldata2 <- cbind(colnames(Sub), coldata2)
names(coldata)[1] <- "filename"
View(coldata2)
coldata2 <- data.frame(
Line = factor(similarLines[[1]], similarLines[[2]])
)
coldata2 <- cbind(colnames(Sub), coldata2)
names(coldata)[1] <- "filename"
ddsFullCountTable <- DESeqDataSetFromMatrix(
countData = Sub,
colData = coldata2,
design = ~ 1 )
dds <- ddsFullCountTable
View(dds)
#run the DESeq pipeline
dds <- DESeq(dds)
count <- as.data.frame(counts(dds, normalized = T))
ggplot(count, aes(x = PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131,
y = PDXcells_P180129T1LVp1m2826_DMEMF12_S4_eaton131))+
#ylim(0, 1e4)+
geom_point()+
geom_smooth(method=lm)+
stat_cor(method = "pearson")
ggplot(count, aes(x = PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131,
y = 	P130411_Cells_S1_eaton02))+
#ylim(0, 1e4)+
geom_point()+
geom_smooth(method=lm)+
stat_cor(method = "pearson")
SubRep <- exSub %>% select(1, 10, 11)
View(SubRep)
View(SubRep)
coldata2 <- data.frame(
Line = factor(allPDXclassical[[1]], allPDXclassical[[5]], allPDXclassical[[5]])
)
coldata2 <- cbind(colnames(SubRep), coldata2)
names(coldata)[1] <- "filename"
coldata2 <- data.frame(
Line = factor(allPDXclassical[[1]], allPDXclassical[[5]], allPDXclassical[[5]])
)
coldata2 <- data.frame(
Line = factor(allPDXclassical[[1]], allPDXclassical[[4]], allPDXclassical[[5]])
)
coldata2 <- data.frame(
Line = factor(allPDXclassical[[1]], allPDXclassical[[4]], allPDXclassical[[5]])
)
coldata2 <- cbind(colnames(SubRep), coldata2)
names(coldata2)[1] <- "filename"
coldata2 <- data.frame(
Line = factor(c(allPDXclassical[[1]], allPDXclassical[[4]], allPDXclassical[[5]]))
)
coldata2 <- cbind(colnames(SubRep), coldata2)
names(coldata2)[1] <- "filename"
ddsFullCountTable <- DESeqDataSetFromMatrix(
countData = SubRep,
colData = coldata2,
design = ~ 1 )
dds <- ddsFullCountTable
#run the DESeq pipeline
dds <- DESeq(dds)
count <- as.data.frame(counts(dds, normalized = T))
ggplot(count, aes(x = PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131,
y = PDXcells_P180129T1LVp1m2826_DMEMF12_S4_eaton131))+
#ylim(0, 1e4)+
geom_point()+
geom_smooth(method=lm)+
stat_cor(method = "pearson")
ggplot(count, aes(x = PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131,
y = 	P130411_Cells_S1_eaton02))+
#ylim(0, 1e4)+
geom_point()+
geom_smooth(method=lm)+
stat_cor(method = "pearson")
ggplot(count, aes(x = PDXcells_P180129T1LVp1m2826_DMEMF12_S4_eaton131,
y = 	P130411_Cells_S1_eaton02))+
#ylim(0, 1e4)+
geom_point()+
geom_smooth(method=lm)+
stat_cor(method = "pearson")
ggplot(count, aes(x = P100422_Cells_S3_eaton02,
y = 	P130411_Cells_S1_eaton02))+
#ylim(0, 1e4)+
geom_point()+
geom_smooth(method=lm)+
stat_cor(method = "pearson")
ggplot(count, aes(x = PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131,
y = 	P130411_Cells_S1_eaton02))+
#ylim(0, 1e4)+
geom_point()+
geom_smooth(method=lm)+
stat_cor(method = "spearman")
ggplot(count, aes(x = PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131,
y = PDXcells_P180129T1LVp1m2826_DMEMF12_S4_eaton131))+
#ylim(0, 1e4)+
geom_point()+
geom_smooth(method=lm)+
stat_cor(method = "spearman")
ggplot(Sub, aes(x = log2(PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131),
y = log2(PDXcells_P180129T1LVp1m2826_DMEMF12_S4_eaton131)))+ #, colour= log(PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131)))+
geom_point()+
geom_smooth(method=lm)+
stat_cor(method = "pearson")
ggplot(count, aes(x = PDXcells_P180129T1LVp1m2826_DMEMF12_S4_eaton131,
y = 	P130411_Cells_S1_eaton02))+
#ylim(0, 1e4)+
geom_point()+
geom_smooth(method=lm)+
stat_cor(method = "pearson")
#scatterplot 	P130411_Cells_S1_eaton02 vs 110616 for comparison
ggplot(count, aes(x = PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131,
y = 	P130411_Cells_S1_eaton02))+
#ylim(0, 1e4)+
geom_point()+
geom_smooth(method=lm)+
stat_cor(method = "pearson")
ggplot(count, aes(x = PDXcells_P110616T1p1m3931_tcp13_frm_frozen_S7_eaton131,
y = PDXcells_P180129T1LVp1m2826_DMEMF12_S4_eaton131))+
#ylim(0, 1e4)+
geom_point()+
geom_smooth(method=lm)+
stat_cor(method = "pearson")
set.seed(seed.use)  # not explicitly needed, but just in case
# load metadata & library keys
data("raw_plates")  # called raw_list in global environment
data("metadata_and_library_key")  # called results in global environment
metadata <- results[[1]]
library_key <- results[[2]]
library_key_2016 <- results[[3]]
load("/Volumes/Jen Jen Yeh Lab/RNAseq/RData/Yeh_Salmon.RData")
View(Yeh_Salmon)
View(Yeh_Salmon[["ex"]])
View(Yeh_Salmon[["sampInfo"]])
library(data.table)
library(tidyverse)
setwd("~/YehLabHTS")
seqMetadata <- readData(parent.dir = "./data/",
file.name = "Sequenced_PDX_CAF_lines",
col.names = TRUE)
library(data.table)
seqMetadata <- readData(parent.dir = "./data/",
file.name = "Sequenced_PDX_CAF_lines",
col.names = TRUE)
library(YehLabHTS)
seqMetadata <- readData(parent.dir = "./data/",
file.name = "Sequenced_PDX_CAF_lines",
col.names = TRUE)
View(seqMetadata)
seqMetadata <- readData(parent.dir = "./data/",
file.name = "Sequenced_PDX_CAF_lines",
col.names = TRUE)
View(seqMetadata)
type <- c("PDXcells")
seqMetadata <- filter(seqMetadata, data/type %in% type)
library(dplyr)
seqMetadata <- filter(seqMetadata, data/type %in% type)
seqMetadata <- filter(seqMetadata,  type %in% data/type)
seqMetadata <- filter(seqMetadata,  data/type == "PDXcells")
seqMetadata2 <- filter(seqMetadata,  Subsample_ID == "S13")
seqMetadata <- readData(parent.dir = "./data/",
file.name = "Sequenced_PDX_CAF_lines",
col.names = TRUE)
seqMetadata <- filter(seqMetadata,  Type == "PDXcells")
View(seqMetadata)
# P140710N1 was also in the screen but removed from analysis due to
# a cell line mix-up: P140710N1 matches P140227T1 for STR
cellLines <- c(P100422, P130411T1, P140227, P170119T1)
type <- c("PDXcells")
# P140710N1 was also in the screen but removed from analysis due to
# a cell line mix-up: P140710N1 matches P140227T1 for STR
cellLines <- c("P100422", "P130411T1", "P140227", "P170119T1")
type <- c("PDXcells")
seqMetadata <- readData(parent.dir = "./data/",
file.name = "Sequenced_PDX_CAF_lines",
col.names = TRUE)
# P140710N1 was also in the screen but removed from analysis due to
# a cell line mix-up: P140710N1 matches P140227T1 for STR
cellLines <- c("P100422", "P130411T1", "P140227", "P170119T1")
seqMetadata <- filter(seqMetadata, Line %in% cellLines, Type == "PDXcells")
rm(seqMetadata2)
expSubset <- subset(Yeh_Salmon[["ex"]], select = c(seqMetadata$fpkm_file_header))
seqMetadata$fpkm_file_header
View(Yeh_Salmon)
View(Yeh_Salmon)
sss
expSubset <- subset(Yeh_Salmon[["ex"]], select = c(seqMetadata$fpkm_file_header))
View(Yeh_Salmon[["ex"]])
filenames <- seqMetadata$fpkm_file_header
expSubset <- subset(Yeh_Salmon[["ex"]], select(seqMetadata$fpkm_file_header))
expSubset <- subset(Yeh_Salmon[["ex"]], select = c(seqMetadata$fpkm_file_header))
expSubset <- subset(Yeh_Salmon[["ex"]], select = c(filenames))
filenames[1]
filenames[[1]]
ex <- subset(Yeh_Salmon[["ex"]], select = c(filenames[1]))
View(ex)
expSubset <- subset(Yeh_Salmon[["ex"]], select = c(filenames))
class(filenames)
filenames <- as.list(seqMetadata$fpkm_file_header)
expSubset <- subset(Yeh_Salmon[["ex"]], select = c(filenames))
filenames <- c()
filenames <- as.list(seqMetadata$fpkm_file_header)
expSubset <- subset(Yeh_Salmon[["ex"]], select = c(filenames))
allPDXclassical <- list("P130411T1", "P100422T1","P190117T2OM", "P110616T1", "P180129T1LV")
type <- c("PDXcells")
drugTx <- c("untreated", "")
treatment1 <- c("untreated", "")
lastFilename <- c()
lastFilename2 <- c()
for (i in 1:length(allPDXclassical)){
#all seq runs for a given cell line in the candidate pdx lines
allRuns <- subset(Yeh_Salmon[["sampInfo"]], line ==  allPDXclassical[[i]])
allRuns <- filter(allRuns, DrugTx %in% drugTx, Treatment1 %in% treatment1, Type %in% type)
#most recent file (last file in allRuns)
filename <- tail(as.character(allRuns$filename), n = 10)
#list of the last file names for each candidate line
lastFilename <- c(lastFilename, filename)
exSub <- subset(Yeh_Salmon[["ex"]], select = c(lastFilename))
# allRuns2 <- subset(Yeh_Salmon[["sampInfo"]], line ==  allPDXclassical[[5]])
# allRuns2 <- filter(allRuns2, Type %in% type, DrugTx %in% drugTx, Treatment1 %in% treatment1)
# #allRuns <- rbind(allRuns, allRuns2)
# filename2 <- tail(as.character(allRuns2$filename), n = 10)
# lastFilename2 <- c(lastFilename2, filename2)
# exSub <- subset(Yeh_Salmon[["ex"]], select = c(lastFilename2))
}
class(lastFilename)
filenames <- as.character(seqMetadata$fpkm_file_header)
expSubset <- subset(Yeh_Salmon[["ex"]], select = c(filenames))
ex <- subset(Yeh_Salmon[["ex"]], select = c(filenames[2]))
View(ex)
ex <- subset(Yeh_Salmon[["ex"]], select = c(filenames[3]))
ex <- subset(Yeh_Salmon[["ex"]], select = c(filenames[4]))
ex <- subset(Yeh_Salmon[["ex"]], select = c(filenames[5]))
ex <- subset(Yeh_Salmon[["ex"]], select = c(filenames[6]))
filenames[5]
seqMetadata[-c(5)]
seqMetadata <- seqMetadata[-c(5),]
filenames <- as.character(seqMetadata$fpkm_file_header)
expSubset <- subset(Yeh_Salmon[["ex"]], select = c(filenames))
filenames <- seqMetadata$fpkm_file_header
expSubset <- subset(Yeh_Salmon[["ex"]], select = c(filenames))
View(seqMetadata)
View(expSubset)
View(expSubset)
